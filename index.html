<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ruben's Website</title>
    <link rel="manifest" href="/manifest.json" />
    <script type="text/javascript">
      var clevertap = {
        event: [],
        profile: [],
        account: [],
        onUserLogin: [],
        notifications: [],
        privacy: [],
      };
      clevertap.account.push({ id: "TEST-K9K-Z94-R46Z" });
      clevertap.privacy.push({ optOut: false });
      clevertap.privacy.push({ useIP: false });
      (function () {
        var wzrk = document.createElement("script");
        wzrk.type = "text/javascript";
        wzrk.async = true;
        wzrk.src =
          ("https:" == document.location.protocol
            ? "https://d2r1yp2w7bby2u.cloudfront.net"
            : "http://static.clevertap.com") + "/js/clevertap.min.js";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(wzrk, s);
      })();
    </script>

    <!-- <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-analytics.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyA0lssNNmg2FUERyplrYN8eN4Sl9VZbqbg",
        authDomain: "clevertap-web-4d5c5.firebaseapp.com",
        projectId: "clevertap-web-4d5c5",
        storageBucket: "clevertap-web-4d5c5.firebasestorage.app",
        messagingSenderId: "356579322319",
        appId: "1:356579322319:web:967e6a445db1c6fd774aba",
        measurementId: "G-GXMZMX5NJW",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
    </script> -->

    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f0f0f0;
      }

      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        width: 100%;
        max-width: 600px;
      }

      .form-container {
        display: flex;
        gap: 20px;
        width: 100%;
        justify-content: center;
      }

      input[type="text"] {
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 5px;
        outline: none;
        width: 100%;
        max-width: 200px; /* Increased the maximum width */
      }

      input[type="text"]:focus {
        border-color: #007bff;
      }

      .button-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        width: 100%;
      }

      .button-container > * {
        flex: 1 0 calc(33.33% - 20px);
        max-width: calc(33.33% - 20px);
      }

      .button {
        padding: 10px 20px;
        font-size: 16px;
        font-weight: bold;
        text-transform: uppercase;
        color: white;
        background-color: #034694;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
        width: 100%;
      }

      .button:hover {
        background-color: #023865;
      }

      button[type="button"] {
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 10px 20px;
        cursor: pointer;
        transition: background-color 0.3s;
        width: 100%;
      }

      button[type="button"]:hover {
        background-color: #0056b3;
      }
    </style>
    

  </head>
  <body>
    <div class="container">
      <div class="form-container">
        <input type="text" id="username" placeholder="Username" />
        <input type="text" id="name" placeholder="Full Name" />
        <input type="text" id="email" placeholder="Email" />
        <input type="text" id="number" placeholder="Phone number" />
        <input type="text" id="eventName" placeholder="Event Name" />
      </div>

      <div class="button-container">
        <button class="button" onclick="pushEvent()">Push Event</button>
        <button class="button" onclick="onuserlogin()">OnUserLogin</button>
        <button class="button" onclick="ipfalse()">IP FALSE</button>
        <button class="button" onclick="iptrue()">IP TRUE</button>
        <button class="button" onclick="profilepush()">ProfilePush</button>
        <button class="button" onclick="pushnotif()">
          Enable Notification
        </button>
        <button class="button" onclick="showctid()">Show CT ID</button>
        <button class="button" onclick="clear()">Clear CT ID</button>
        <button class="button" onclick="popup()">Web Pop-up</button>
        <button class="button" onclick="pushnotification()">Web Push</button>
      </div>
    </div>

    <h2 id="test"></h2>

    <script>
      function pageLoad() {
        const fullUrl = window.location.href;

        // Extract the base URL (before .io)
        const baseUrl = fullUrl.split(":5500")[0] + ":5500";

        // Extract the path (everything after .io)
        const path = fullUrl.split(":5500")[1] || "/";

        const props = {
            "URL": fullUrl,
            "Path": path,
            "Base": baseUrl
          };

          if (window.my_webview) {
            my_webview.pushEvent("Page Viewed", JSON.stringify(props));
          } else {
            clevertap.event.push("Page Viewed", props);
          }

          
      }

      window.onload = pageLoad;
      

      function pushEvent() {
        const inputField = document.getElementById("eventName");
        const value = inputField.value.trim(); // Trim removes any leading/trailing spaces

        if (value === "") {
          const props = {
            "Product name": "Casio Chronograph Watch",
            Category: "Mens Accessories",
            Price: 59.99,
            Date: new Date(),
          };
          if (window.my_webview) {
            my_webview.pushEvent("Product Viewed", JSON.stringify(props));
          } else {
            clevertap.event.push("Product Viewed", props);
          }
        } else {
          if (window.my_webview) {
            my_webview.pushEvent(inputField.value);
          } else {
            clevertap.event.push(inputField.value);
          }
        }
      }

      function onuserlogin() {
        // Collect user data into a dictionary
        const userData = {
          Name: document.getElementById("name").value,
          Identity: document.getElementById("username").value,
          Email: document.getElementById("email").value,
          Phone: document.getElementById("number").value,
          "Sign Up": new Date(),
          "MSG-email": true,
          "MSG-push": true,
          "MSG-sms": true,
          "MSG-whatsapp": true,
        };

        // Create the data structure with "Site" key for normal web working
        const siteData = {
          Site: userData,
        };

        // Handle for Android
        if (window.my_webview) {
          my_webview.onUserLogin(JSON.stringify(userData));
          document.getElementById("name").value = "";
          document.getElementById("username").value = "";
          document.getElementById("email").value = "";
          document.getElementById("number").value = "";
        }
        // Handle for web
        else {
          clevertap.onUserLogin.push(siteData);
          document.getElementById("name").value = "";
          document.getElementById("username").value = "";
          document.getElementById("email").value = "";
          document.getElementById("number").value = "";
        }
      }

      function popup() {
        if (window.my_webview) {
          my_webview.pushEvent("Web Pop-up");
        } else {
          clevertap.event.push("Web Pop-up");
        }
      }

      let pushnotification = () => {
        const eventName = "Web Push Notification";

        // Android: Use `my_webview` to call the native interface
        if (window.my_webview) {
          my_webview.pushEvent(eventName);
        } else {
          clevertap.event.push(eventName);
        }
      };

      let profilepush = () => {
        // Data to be pushed for the profile
        const profileData = {
          "Customer Type": "Silver",
          "Preferred Language": "English",
          "MSG-push": false,
          "MSG-email": false,
        };

        // Web: CleverTap requires "Site" key
        const siteProfileData = {
          Site: profileData,
        };

        // Android: Use `my_webview` to call the native interface
        if (window.my_webview) {
          my_webview.pushProfile(JSON.stringify(profileData));
        } else {
          clevertap.profile.push(siteProfileData);
        }
      };

      let ipfalse = () => {
        clevertap.privacy.push({ useIP: false });
        clevertap.event.push("useIP: false");
      };

      let iptrue = () => {
        clevertap.privacy.push({ useIP: true });
        clevertap.event.push("useIP: true");
      };

      let showctid = () => {
        if (window.my_webview) {
          var ctid = my_webview.getCleverTapID();
        } else {
          var ctid = clevertap.getCleverTapID();
        }
        document.getElementById("test").innerHTML = ctid;
      };

      let clear = () => {
        clevertap.clear();
        var cookies = document.cookie.split(";");

        for (var i = 0; i < cookies.length; i++) {
          var cookie = cookies[i];
          var eqPos = cookie.indexOf("=");
          var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;

          // Set the expiry date of the cookie to a past date
          document.cookie =
            name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
        }
      };

      let pushnotif = () => {
       
    clevertap.notifications.push({
      titleText: "Would you like to receive Push Notifications?",
      bodyText:
        "We promise to only send you relevant content and give you updates on your transactions",
      okButtonText: "Sign me up!",
      rejectButtonText: "No thanks",
      okButtonColor: "#F28046",
      askAgainTimeInSeconds: 5,
      "serviceWorkerPath": "clevertap_sw.js"
    })
        
      };

      window.onload = pushnotif;
      
      // Add other functions like profilepush(), ipfalse(), iptrue(), etc. similarly
    </script>

    <script>
      function handleTabClosing(event) {
        clevertap.event.push("Web Exit");
        event.returnValue = "Are you sure you want to leave this page?";
      }
      window.addEventListener("beforeunload", handleTabClosing);

      const closeButton = document.querySelector(".close-button");
      closeButton.addEventListener("click", () => {
        // Remove the beforeunload event listener when the button is clicked
        window.removeEventListener("beforeunload", handleTabClosing);
        // Close the tab (this may not work in all browsers)
        window.close();
      });
    </script>
  </body>
</html>
